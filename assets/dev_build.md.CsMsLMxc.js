import{_ as i,C as l,o as p,c as t,a3 as r,j as a,a as n,E as d}from"./chunks/framework.CqFBhNnV.js";const F=JSON.parse('{"title":"构建指南","description":"","frontmatter":{"title":"构建指南","order":4},"headers":[],"relativePath":"dev/build.md","filePath":"dev/build.md","lastUpdated":1772007002000}'),c={name:"dev/build.md"},h={id:"ci-cd",tabindex:"-1"};function o(b,s,u,k,m,g){const e=l("Badge");return p(),t("div",null,[s[3]||(s[3]=r(`<h1 id="构建指南" tabindex="-1">构建指南 <a class="header-anchor" href="#构建指南" aria-label="Permalink to &quot;构建指南&quot;">​</a></h1><h2 id="模块构建命令" tabindex="-1">模块构建命令 <a class="header-anchor" href="#模块构建命令" aria-label="Permalink to &quot;模块构建命令&quot;">​</a></h2><h3 id="运行桌面应用-开发模式" tabindex="-1">运行桌面应用（开发模式） <a class="header-anchor" href="#运行桌面应用-开发模式" aria-label="Permalink to &quot;运行桌面应用（开发模式）&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./gradlew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :composeApp:run</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>启动 Compose Desktop 应用，内嵌 WebView 加载前端页面。这是日常开发的主要入口。</p><h3 id="构建共享模块" tabindex="-1">构建共享模块 <a class="header-anchor" href="#构建共享模块" aria-label="Permalink to &quot;构建共享模块&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./gradlew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :shared:build</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>构建 <code>shared</code> 模块，会重新生成 JSON Schema 相关的代码。修改了 API 数据模型后需要重新执行此命令。</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 附加 --info 查看详细构建日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./gradlew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :shared:build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --info</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="构建前端" tabindex="-1">构建前端 <a class="header-anchor" href="#构建前端" aria-label="Permalink to &quot;构建前端&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装 Node 依赖（首次或依赖变更后）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 构建前端产物（输出到 fredica-webui/build/）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docs:build</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>或进入前端目录单独构建：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fredica-webui</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="构建桌面发行包" tabindex="-1">构建桌面发行包 <a class="header-anchor" href="#构建桌面发行包" aria-label="Permalink to &quot;构建桌面发行包&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows 安装包（.msi 或 .exe）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./gradlew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :composeApp:packageMsi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./gradlew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :composeApp:packageExe</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># macOS DMG</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./gradlew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :composeApp:packageDmg</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Linux DEB / RPM</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./gradlew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :composeApp:packageDeb</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./gradlew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :composeApp:packageRpm</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>打包命令需要在目标平台上运行。例如，构建 <code>.msi</code> 需要在 Windows 上执行。</p></div><h3 id="构建独立-server-jar-实验性" tabindex="-1">构建独立 Server JAR（实验性） <a class="header-anchor" href="#构建独立-server-jar-实验性" aria-label="Permalink to &quot;构建独立 Server JAR（实验性）&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./gradlew</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :server:buildFatJar</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>生成包含所有依赖的可独立运行 JAR 文件。</p><hr><h2 id="关键依赖版本" tabindex="-1">关键依赖版本 <a class="header-anchor" href="#关键依赖版本" aria-label="Permalink to &quot;关键依赖版本&quot;">​</a></h2><table tabindex="0"><thead><tr><th>依赖</th><th>版本</th></tr></thead><tbody><tr><td>Kotlin</td><td><code>2.3.0</code></td></tr><tr><td>Compose Multiplatform</td><td><code>1.9.3</code></td></tr><tr><td>Ktor</td><td><code>3.3.3</code></td></tr><tr><td>Ktorm</td><td><code>4.1.1</code></td></tr><tr><td>Kotlinx Serialization</td><td><code>1.9.0</code></td></tr><tr><td>Kotlinx Coroutines</td><td><code>1.10.2</code></td></tr><tr><td>Kotlinx DateTime</td><td><code>0.7.1</code></td></tr><tr><td>React</td><td><code>19.2.3</code></td></tr><tr><td>React Router</td><td><code>7.11.0</code></td></tr><tr><td>Tailwind CSS</td><td><code>4.1.13</code></td></tr><tr><td>Vite / TypeScript</td><td>最新稳定版</td></tr></tbody></table><p>完整依赖版本定义在 <code>gradle/libs.versions.toml</code>。</p><hr><h2 id="项目结构速览" tabindex="-1">项目结构速览 <a class="header-anchor" href="#项目结构速览" aria-label="Permalink to &quot;项目结构速览&quot;">​</a></h2><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>fredica/</span></span>
<span class="line"><span>├── composeApp/          # Compose Multiplatform 桌面应用</span></span>
<span class="line"><span>│   └── src/</span></span>
<span class="line"><span>│       ├── commonMain/  # 跨平台 UI 代码</span></span>
<span class="line"><span>│       ├── jvmMain/     # JVM 平台特定代码</span></span>
<span class="line"><span>│       └── androidMain/ # Android 特定代码</span></span>
<span class="line"><span>├── shared/              # 跨平台核心业务逻辑</span></span>
<span class="line"><span>│   └── src/</span></span>
<span class="line"><span>│       ├── commonMain/  # 共享代码（API、DB 模型、工具）</span></span>
<span class="line"><span>│       └── jvmMain/     # JVM 实现（Ktor 服务器启动）</span></span>
<span class="line"><span>├── fredica-webui/       # React 前端</span></span>
<span class="line"><span>│   └── app/routes/      # 页面路由文件</span></span>
<span class="line"><span>├── server/              # 独立服务器模块（实验性）</span></span>
<span class="line"><span>├── docs/                # VitePress 文档</span></span>
<span class="line"><span>├── build.gradle.kts     # 根构建脚本</span></span>
<span class="line"><span>├── settings.gradle.kts  # 模块注册</span></span>
<span class="line"><span>├── gradle/</span></span>
<span class="line"><span>│   └── libs.versions.toml  # 统一版本管理</span></span>
<span class="line"><span>└── package.json         # Node 脚本（文档 + 前端）</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><hr>`,27)),a("h2",h,[s[0]||(s[0]=n("CI/CD ",-1)),d(e,{type:"warning",text:"尚待开发"}),s[1]||(s[1]=n()),s[2]||(s[2]=a("a",{class:"header-anchor",href:"#ci-cd","aria-label":'Permalink to "CI/CD <Badge type="warning" text="尚待开发" />"'},"​",-1))]),s[4]||(s[4]=a("div",{class:"warning custom-block"},[a("p",{class:"custom-block-title"},"尚待开发"),a("p",null,"持续集成和自动发布流程尚未配置。以下为规划内容。")],-1)),s[5]||(s[5]=a("p",null,"计划使用 GitHub Actions 实现：",-1)),s[6]||(s[6]=a("ul",null,[a("li",null,"PR 提交时自动运行 Kotlin 单元测试"),a("li",null,"Tag 推送时自动构建各平台安装包并发布到 GitHub Releases"),a("li",null,"文档推送时自动部署到 GitHub Pages")],-1))])}const C=i(c,[["render",o]]);export{F as __pageData,C as default};
